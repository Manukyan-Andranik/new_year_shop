{% extends "base.html" %}

{% block content %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Roboto+Serif:wght@400;500&display=swap">
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Merriweather:wght@400;500;700&display=swap"
  rel="stylesheet">

{% endblock %}

<body>
  <div class="app-container">
    <aside id="catalog-panel" role="complementary" aria-label="Product catalog">
      <h2 data-translate="catalog.title">ğŸ Toy Catalog</h2>
  
      <!-- Category header with buttons and tree badge side by side -->
      <div class="category-header">
        <div class="category-menu" role="navigation" aria-label="Product categories">
          <button class="category-btn active" data-category="all" data-translate="category.all">All Toys</button>
          <button class="category-btn" data-category="small" data-translate="category.small">Small</button>
          <button class="category-btn" data-category="big" data-translate="category.big">Big</button>
          <button class="category-btn" data-category="for_business" data-translate="category.business">For Business</button>
        </div>
  
        <!-- Tree badge now positioned to the right of category buttons -->
        <div class="tree-badge" role="status" aria-live="polite" aria-atomic="true">
          <span id="cart-count">0</span>
          <span data-translate="cert.badge">toys on tree</span>
        </div>
      </div>
  
      <div class="product-grid" role="list"></div>
    </aside>
  
    <main id="canvas-container" role="main">
      <!-- your canvas or tree rendering here -->
    </main>
  </div>
  
  

  <button id="checkout-btn" disabled data-translate-aria="checkout.disabled">
    <span class="emoji">ğŸ…</span><span id="checkout-text" data-translate="checkout.button">Send to Santa</span>
  </button>


  <div id="success-overlay" class="modal-overlay" role="dialog" aria-labelledby="success-title" aria-modal="true">
    <div class="order-paper-card"
      style="max-width:520px;text-align:center;background: #fffdf5; border: 2px solid #e0c497; border-radius: 16px; padding: 28px; box-shadow: 0 0 20px rgba(255,215,160,0.4); font-family: 'Great Vibes', cursive; color:#5a3d1a;">
      <h3 id="success-title" style="font-size: 28px; color:#b83232;" data-translate="success.title">ğŸ’Œ Letter Sent to Santa!</h3>
      <p style="font-family: 'Georgia', serif; font-size: 16px; line-height: 1.6; color:#5a3d1a; margin-top: 12px;" data-translate="success.message">
        Your heartfelt Christmas wish has just fluttered across the snowy skies to the North Pole! ğŸ„ Santa's elves are
        already wrapping your chosen toys with ribbons and magic dust. Thank you for keeping the Christmas spirit alive!
        ğŸŒŸ
      </p>
      <p style="font-family: 'Great Vibes', cursive; font-size: 22px; margin-top: 14px; color:#b83232;" data-translate="success.signature">
        âœ¨ With love and festive cheer,<br>Santa's Workshop ğŸ…
      </p>
      <button class="close-btn" id="close-success"
        style="margin-top:18px;display:inline-block;background:#b83232;color:white;padding:10px 22px;border-radius:24px;border:none;font-family:'Georgia',serif;font-size:15px;cursor:pointer;transition:0.3s;"
        data-translate="success.continue">
        Continue Shopping ğŸ
      </button>
    </div>
  </div>

  <div id="order-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="paper-title">
    <div class="order-paper-card" role="document">
      <!-- Fixed Header Section -->
      <div class="paper-header">
        <div>
          <div class="paper-title" style="font-family:'Great Vibes', cursive; font-size:30px; color:#b83232;" data-translate="order.title">
            âœ‰ï¸ Letter to Santa â€” Your Christmas Wishes
          </div>
          <div class="paper-sub" style="font-size:15px; color:#7a5a3a;" data-translate="order.subtitle">
            Let's make sure Santa gets your favorite toys right!
          </div>
        </div>
        <div style="text-align:right;">
          <div style="font-size:13px;color:#7a5a3a;" data-translate="order.preview">Order Preview</div>
          <div style="font-weight:700;color:var(--festive-green);font-size:18px" id="modal-items-count">0 items</div>
        </div>
      </div>
  
      <!-- Scrollable Content Area -->
      <div class="scrollable-content" style="flex: 1; overflow-y: auto; min-height: 0;">
        
        <!-- Order List with Horizontal Scrolling -->
        <div class="order-list-container" style="margin-bottom: 16px;">
          <div class="order-list" id="order-list"></div>
        </div>
  
        <!-- Customer Form -->
        <div class="paper-footer" style="border-top:1px dashed #e0c497;padding-top:12px;">
          <div class="paper-total" style="font-weight:bold;font-size:17px; margin-bottom: 12px;">
            <span data-translate="order.total">Total:</span> <span id="paper-total" style="color:#b83232;">$0.00</span>
          </div>
          <form id="order-form" style="width:100%; display:flex; flex-direction:column; gap:10px;">
            <input type="text" id="customer-name" placeholder="Your Name" required data-translate="order.form.name">
            <input type="email" id="customer-email" placeholder="Your Email" required data-translate="order.form.email">
            <input type="text" id="customer-phone" placeholder="Your Phone" required data-translate="order.form.phone">
            <textarea id="santa-message" placeholder="Your Message to Santa" required data-translate="order.form.message"></textarea>
            <div class="paper-actions" style="display:flex; justify-content:flex-end; gap:12px; margin-top:8px;">
              <button type="button" class="btn-secondary" id="paper-cancel"
                style="background:#e4d4b7;color:#5a3d1a;border:none;border-radius:20px;padding:8px 16px;font-size:14px;cursor:pointer;transition:0.3s;"
                data-translate="order.buttons.back">
                Back to Shop ğŸ›’
              </button>
              <button type="submit" class="btn-primary" id="paper-confirm"
                style="background:#b83232;color:white;border:none;border-radius:20px;padding:8px 16px;font-size:14px;cursor:pointer;transition:0.3s;"
                data-translate="order.buttons.send">
                Send to Santa âœ¨
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div id="product-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="product-modal-title">
    <div class="paper-card" role="document">
      <div class="gallery">
        <div class="gallery-main" id="gallery-main">
          <button type="button" class="nav-btn" id="gallery-prev" data-translate-aria="product.gallery.prev"
            style="position:absolute; left:10px; top:50%; transform:translateY(-50%);">â—€</button>
          <img id="gallery-image" src="" alt="Product large view">
          <button type="button" class="nav-btn" id="gallery-next" data-translate-aria="product.gallery.next"
            style="position:absolute; right:10px; top:50%; transform:translateY(-50%);">â–¶</button>
        </div>
        <div class="gallery-thumbs" id="gallery-thumbs" data-translate-aria="product.gallery.thumbs"></div>
      </div>
      <div class="gallery-right" style="display:flex; flex-direction:column;">
        <div class="product-details">
          <h3 id="product-modal-title" data-translate="product.modal.title">Toy Name</h3>
          <div class="product-price" id="product-modal-price" data-translate="product.modal.price">$0.00</div>
          <p id="product-modal-description" data-translate="product.modal.description">Product description.</p>
        </div>
        <div class="product-specs" id="product-modal-specs" aria-labelledby="product-specs"></div>
        <div style="margin-top:auto;display:flex;gap:8px;">
          <button class="add-btn" id="modal-add-btn" data-translate="product.modal.add"><span class="icon">ğŸ</span>Add to Tree</button>
          <button class="btn-secondary" id="modal-close" data-translate="product.modal.close">Close</button>
        </div>
      </div>
    </div>
  </div>

  <div id="announcements" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

  <script src="{{ url_for('static', filename='js/translations.js') }}"></script>
  <script src="{{ url_for('static', filename='js/api.js') }}"></script>
  <script src="{{ url_for('static', filename='js/scene.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui.js') }}"></script>
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

{% endblock %}